{% extends "base.html" %}
{% block content %}

<section class="card report-card">

  <!-- Brand strip -->
  <div class="brand-strip">
    <div class="brand-name">Enviro Labs LLC</div>
    <div class="brand-contacts">
      <span>Email: <a href="mailto:support@envirolabsusa.com">support@envirolabsusa.com</a></span>
    </div>
  </div>

  <div class="report-header">
    <h1>Report for Lab ID: <span class="mono">{{ r.lab_id }}</span></h1>
    <div class="actions">
      <a class="button" href="javascript:history.back()">Back</a>
      <button class="button primary" onclick="window.print()">Print PDF</button>
    </div>
  </div>

  <!-- Client Information -->
  <h2 class="section-title">Client Information</h2>
  <div class="kv-grid">
    <div class="kv"><div class="k">Client</div><div class="v">{{ p.client_info.client or r.client or "" }}</div></div>
    <div class="kv"><div class="k">Phone</div><div class="v">{{ p.client_info.phone or "" }}</div></div>
    <div class="kv"><div class="k">Client Email</div><div class="v">{{ p.client_info.email or "" }}</div></div>
    <div class="kv"><div class="k">Project Lead</div><div class="v">{{ p.client_info.project_lead or "" }}</div></div>
    <div class="kv span-2"><div class="k">Address</div><div class="v">{{ p.client_info.address or "" }}</div></div>
  </div>

  <!-- Sample Summary -->
  <h2 class="section-title">Sample Summary</h2>
  <div class="kv-grid">
    <div class="kv"><div class="k">Reported</div><div class="v">{{ p.sample_summary.reported or (r.resulted_date.isoformat() if r.resulted_date else "") }}</div></div>
    <div class="kv"><div class="k">Received Date</div><div class="v">{{ p.sample_summary.received_date or (r.collected_date.isoformat() if r.collected_date else "") }}</div></div>
    <div class="kv span-2"><div class="k">Sample Name</div><div class="v">{{ p.sample_summary.sample_name or r.patient_name or "" }}</div></div>
    <div class="kv"><div class="k">Prepared By</div><div class="v">{{ p.sample_summary.prepared_by or "" }}</div></div>
    <div class="kv"><div class="k">Matrix</div><div class="v">{{ p.sample_summary.matrix or "" }}</div></div>
    <div class="kv"><div class="k">Prepared Date</div><div class="v">{{ p.sample_summary.prepared_date or "" }}</div></div>
    <div class="kv"><div class="k">ASIN (Identifier)</div><div class="v">{{ p.sample_summary.asin or "" }}</div></div>
    <div class="kv"><div class="k">Product Weight (g)</div><div class="v">{{ p.sample_summary.product_weight_g or "" }}</div></div>
    <div class="kv span-2"><div class="k">Qualifiers</div><div class="v">{{ p.sample_summary.qualifiers or "" }}</div></div>
  </div>

  <!-- Sample Results -->
  <h2 class="section-title">Sample Results</h2>
  <table class="table report-table">
    <thead>
      <tr>
        <th>Analyte</th>
        <th>Result</th>
        <th>MRL</th>
        <th>Units</th>
        <th>Dilution</th>
        <th>Analyzed</th>
        <th>Qualifier</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>{{ p.sample_results.analyte or r.test or "" }}</td>
        <td>{{ p.sample_results.result or r.result or "" }}</td>
        <td>{{ p.sample_results.mrl or "" }}</td>
        <td>{{ p.sample_results.units or "" }}</td>
        <td>{
