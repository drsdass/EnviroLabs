{% extends "base.html" %}
{% block title %}Report {{ r.lab_id }} | Enviro Labs{% endblock %}

{% block content %}
<div class="report-header">
  <h1>Report for Lab ID: <span class="mono">{{ r.lab_id }}</span></h1>
  <div class="header-actions no-print">
    <a href="{{ url_for('dashboard') }}" class="button secondary">← Back</a>
    <button class="button" onclick="window.print()">Print PDF</button>
  </div>
</div>

<!-- Company brand bar -->
<div class="brand-bar">
  <div class="brand-left">
    <img src="{{ url_for('static', filename='logo.png') }}" alt="Enviro Labs" class="brand-logo">
    <div class="brand-name">Enviro Labs LLC</div>
  </div>
  <div class="brand-right">
    <div class="brand-label">Email</div>
    <div class="brand-value"><a href="mailto:support@envirolabsusa.com">support@envirolabsusa.com</a></div>
  </div>
</div>

<!-- Client Information -->
<section class="card">
  <h2>Client Information</h2>
  <div class="grid grid-4">
    <div class="field">
      <div class="label">Client</div>
      <div class="value">{{ p.client_info.client }}</div>
    </div>
    <div class="field">
      <div class="label">Phone</div>
      <div class="value">{{ p.client_info.phone }}</div>
    </div>
    <div class="field">
      <div class="label">Email</div>
      <div class="value">
        {% if p.client_info.email %}
          <a href="mailto:{{ p.client_info.email }}">{{ p.client_info.email }}</a>
        {% else %}
          —
        {% endif %}
      </div>
    </div>
    <div class="field">
      <div class="label">Project Lead</div>
      <div class="value">{{ p.client_info.project_lead }}</div>
    </div>
    <div class="field span-4">
      <div class="label">Address</div>
      <div class="value">{{ p.client_info.address }}</div>
    </div>
  </div>
</section>

<!-- Sample Summary -->
<section class="card">
  <h2>Sample Summary</h2>
  <div class="grid grid-4">
    <div class="field">
      <div class="label">Reported</div>
      <div class="value">{{ p.sample_summary.reported }}</div>
    </div>
    <div class="field">
      <div class="label">Received Date</div>
      <div class="value">{{ p.sample_summary.received_date }}</div>
    </div>
    <div class="field">
      <div class="label">Sample Name</div>
      <div class="value">{{ p.sample_summary.sample_name }}</div>
    </div>
    <div class="field">
      <div class="label">Prepared By</div>
      <div class="value">{{ p.sample_summary.prepared_by }}</div>
    </div>

    <div class="field">
      <div class="label">Matrix</div>
      <div class="value">{{ p.sample_summary.matrix }}</div>
    </div>
    <div class="field">
      <div class="label">Prepared Date</div>
      <div class="value">{{ p.sample_summary.prepared_date }}</div>
    </div>
    <div class="field">
      <div class="label">ASIN (Identifier)</div>
      <div class="value">{{ p.sample_summary.asin }}</div>
    </div>
    <div class="field">
      <div class="label">Product Weight (g)</div>
      <div class="value">{{ p.sample_summary.product_weight_g }}</div>
    </div>
  </div>
</section>

<!-- Sample Results -->
<section class="card">
  <h2>Sample Results</h2>
  <table class="table">
    <thead>
      <tr>
        <th>Analyte</th>
        <th>Result</th>
        <th>MRL</th>
        <th>Units</th>
        <th>Dilution</th>
        <th>Analyzed</th>
        <th>Qualifier</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>{{ p.sample_results.analyte }}</td>
        <td class="mono">{{ p.sample_results.result }}</td>
        <td class="mono">{{ p.sample_results.mrl }}</td>
        <td>{{ p.sample_results.units or p.sample_summary.units }}</td>
        <td>{{ p.sample_results.dilution }}</td>
        <td>{{ p.sample_results.analyzed }}</td>
        <td>{{ p.sample_results.qualifier }}</td>
      </tr>
    </tbody>
  </table>

  <p class="note">
    This is a complete final report. The information in this report only applies to the sample submitted in this work order.
    This analytical report must be reproduced in its entirety.
  </p>
</section>

<!-- QC: Method Blank -->
<section class="card">
  <h2>Method Blank</h2>
  <table class="table">
    <thead>
      <tr>
        <th>Analyte</th>
        <th>Result</th>
        <th>MRL</th>
        <th>Units</th>
        <th>Dilution</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>{{ p.method_blank.analyte }}</td>
        <td class="mono">{{ p.method_blank.result }}</td>
        <td class="mono">{{ p.method_blank.mrl }}</td>
        <td>{{ p.method_blank.units }}</td>
        <td>{{ p.method_blank.dilution }}</td>
      </tr>
    </tbody>
  </table>
</section>

<!-- QC: Matrix Spike 1 -->
<section class="card">
  <h2>Matrix Spike 1</h2>
  <table class="table">
    <thead>
      <tr>
        <th>Analyte</th>
        <th>Result</th>
        <th>MRL</th>
        <th>Units</th>
        <th>Dilution</th>
        <th>Fortified Level</th>
        <th>%REC</th>
        <th>%REC Limits</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>{{ p.matrix_spike_1.analyte }}</td>
        <td class="mono">{{ p.matrix_spike_1.result }}</td>
        <td class="mono">{{ p.matrix_spike_1.mrl }}</td>
        <td>{{ p.matrix_spike_1.units }}</td>
        <td>{{ p.matrix_spike_1.dilution }}</td>
        <td class="mono">{{ p.matrix_spike_1.fortified_level }}</td>
        <td class="mono">{{ p.matrix_spike_1.pct_rec }}</td>
        <td class="mono">{{ p.matrix_spike_1.pct_rec_limits }}</td>
      </tr>
    </tbody>
  </table>
</section>

<!-- QC: Matrix Spike Duplicate -->
<section class="card">
  <h2>Matrix Spike Duplicate</h2>
  <table class="table">
    <thead>
      <tr>
        <th>Analyte</th>
        <th>Result</th>
        <th>Units</th>
        <th>Dilution</th>
        <th>%REC</th>
        <th>%REC Limits</th>
        <th>%RPD</th>
        <th>%RPD Limit</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>{{ p.matrix_spike_dup.analyte }}</td>
        <td class="mono">{{ p.matrix_spike_dup.result }}</td>
        <td>{{ p.matrix_spike_dup.units }}</td>
        <td>{{ p.matrix_spike_dup.dilution }}</td>
        <td class="mono">{{ p.matrix_spike_dup.pct_rec }}</td>
        <td class="mono">{{ p.matrix_spike_dup.pct_rec_limits }}</td>
        <td class="mono">{{ p.matrix_spike_dup.pct_rpd }}</td>
        <td class="mono">{{ p.matrix_spike_dup.pct_rpd_limit }}</td>
      </tr>
    </tbody>
  </table>
</section>

<!-- Reviewed By -->
<section class="card">
  <div class="reviewed">
    <div class="reviewed-label">Reviewed by:</div>
    <div class="reviewed-line"></div>
    <div class="reviewed-sub">Signature of Lab Director / Reviewer</div>
  </div>
</section>

<!-- Definitions, Remarks, and Address -->
<section class="card">
  <h2>Definitions and Remarks</h2>
  <dl class="defs">
    <dt>%REC</dt><dd>Percent Recovery</dd>
    <dt>MRL</dt><dd>The minimum levels, concentrations, or quantities of a target variable that can be reported with a specified degree of confidence (also known as LOQ).</dd>
    <dt>ND</dt><dd>Not Detected at or above the MRL (or MDL where applicable).</dd>
    <dt>RPD</dt><dd>Relative Percent Difference.</dd>
    <dt>MS1</dt><dd>The MS and/or MSD recoveries are outside the acceptance limits due to the source sample concentration being greater than 4× the spike concentration. The surrogate recoveries are within acceptance criteria.</dd>
  </dl>

  <p class="note">
    Any remaining sample(s) will be disposed of one month from the final report date unless other arrangements are made in advance.
  </p>

  <h3>Disclaimer</h3>
  <p class="note">
    The results detailed in this report are provided for informational purposes related to the consumer products analysis of BPS, PFAS, and related compounds. These findings are estimated quantities and intended solely for the client's use as requested. All results, interpretations, and conclusions are based on the data obtained during the experiment and are subject to limitations inherent in the methods used. The laboratory assumes no responsibility for the interpretation or use of these results beyond their analytical scope, nor for any decisions or actions taken based on this information. It is the client’s responsibility to ensure compliance with all applicable regulatory standards.
  </p>

  <address class="address">
    Enviro Labs LLC • 18102 Sky Park Cir Suite G, Irvine, CA 92614 • (949) 892-1915 •
    <a href="mailto:support@envirolabsusa.com">support@envirolabsusa.com</a>
  </address>
</section>
{% endblock %}
