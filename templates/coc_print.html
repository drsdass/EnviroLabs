{% extends "base.html" %}

{% block content %}
<section class="card">
  <div style="display:flex; justify-content:space-between; align-items:flex-start; gap:16px; flex-wrap:wrap;">
    <div>
      <h1 style="margin:0;">Chain of Custody (Print)</h1>
      <p style="margin:6px 0 0 0; opacity:0.8;">
        Generated (UTC): {{ now }}
      </p>
    </div>

    <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
      <button class="button" onclick="window.print()">Print</button>
      <a class="button secondary" href="{{ url_for('coc_list') }}">Back</a>
    </div>
  </div>
</section>

<section class="card" style="margin-top:14px; overflow:auto;">
  <table class="table">
    <thead>
      <tr>
        <th>SAMPLE I.D. / NAME</th>
        <th>LAB ID#</th>
        <th>ASIN (Identifier)</th>
        <th>SAMPLE TYPE</th>
        <th>SHIPPED BY</th>
        <th>SAMPLE CONDITION</th>
        <th>TEST(S) REQUESTED</th>
        <th>Status</th>
        <th>Received On</th>
        <th>Received By</th>
      </tr>
    </thead>

    <tbody>
      {% for r in records %}
        <tr>
          <td>{{ r.sample_name or "" }}</td>
          <td>{{ r.lab_id or "" }}</td>
          <td>{{ r.asin or "" }}</td>
          <td>{{ r.sample_type or r.matrix or "" }}</td>
          <td>{{ r.carrier_name or "" }}</td>
          <td>{{ r.sample_condition or "" }}</td>
          <td>{{ r.anticipated_chemical or "" }}</td>
          <td>{{ r.status or "Pending" }}</td>
          <td>
            {% if r.received_at %}
              {{ r.received_at.strftime("%Y-%m-%d %H:%M:%S") }}
            {% else %}
              —
            {% endif %}
          </td>
          <td>{{ r.received_by or "—" }}</td>
        </tr>
      {% endfor %}

      {% if not records %}
        <tr>
          <td colspan="10" style="text-align:center; opacity:0.8;">
            No samples to print.
          </td>
        </tr>
      {% endif %}
    </tbody>
  </table>
</section>

<style>
  @media print {
    .site-header, .site-footer, .nav, .button, .card a.button { display: none !important; }
    .card { box-shadow: none !important; border: none !important; }
    .table { font-size: 10px; }
  }
</style>
{% endblock %}
